import{_ as F}from"./-3dAfoJh.js";import{e as Y,f as O,g as U,h as W,o as a,c as l,a as e,i as G,j as s,F as T,r as B,n as V,t as n,k as J,l as w,d as h,b as K,w as E,m as P,p as c,q as j,s as Q}from"./CGgRb6Y2.js";import{u as X}from"./8YOxgAgS.js";import{_ as Z}from"./DlAUqK2U.js";const ee={class:"min-h-screen bg-gray-50 dark:bg-gray-900"},te={class:"sticky top-0 z-20 bg-white/80 dark:bg-gray-900/80 backdrop-blur-sm border-b border-gray-200 dark:border-gray-800 shadow-sm"},re={class:"container mx-auto px-4 py-3 max-w-5xl flex justify-between items-center"},oe={class:"flex items-center gap-6"},se={xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-gray-700 dark:text-gray-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},ae={key:0,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"},le={key:1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"},ne={class:"container mx-auto px-4 py-8 max-w-5xl flex flex-col lg:flex-row gap-8"},de={class:"lg:w-64 shrink-0"},ie={class:"sticky top-24 bg-white dark:bg-gray-800 rounded-xl shadow-md p-4 border border-gray-100 dark:border-gray-700 hidden lg:block"},ce={key:0,class:"space-y-2 text-sm"},ue=["onClick"],ge={key:1,class:"text-sm text-gray-500 dark:text-gray-400 py-2"},xe={class:"bg-white dark:bg-gray-800 w-full max-h-[80vh] rounded-t-xl p-6 overflow-y-auto"},he={class:"flex justify-between items-center mb-4"},ke={key:0,class:"space-y-2 text-sm"},ve=["onClick"],pe={key:1,class:"text-sm text-gray-500 dark:text-gray-400 py-2"},we={class:"flex-1 max-w-3xl"},me={key:0,class:"text-center py-20"},be={key:1,class:"py-16 text-center"},fe={class:"text-red-500 dark:text-red-400 text-xl font-medium"},ye={key:2,class:"bg-white dark:bg-gray-800 rounded-xl shadow-md border border-gray-100 dark:border-gray-700 overflow-hidden"},_e={class:"p-6 md:p-8 border-b border-gray-200 dark:border-gray-700"},Me={class:"text-3xl md:text-4xl font-bold text-gray-800 dark:text-white mb-4"},Ce={class:"flex flex-wrap gap-3 md:gap-4 text-sm text-gray-500 dark:text-gray-400 mb-4"},Te={class:"flex items-center gap-1"},Be={key:0,class:"flex items-center gap-1"},je={class:"flex items-center gap-1"},$e={class:"flex items-center gap-1"},ze={class:"flex items-center gap-1"},Ae={class:"flex flex-wrap gap-2 mt-2"},Le={key:0,class:"text-xs text-gray-400 dark:text-gray-500"},Ve=["innerHTML"],Ee={class:"bg-white dark:bg-gray-900 border-t border-gray-200 dark:border-gray-800 mt-16"},Ne={class:"container mx-auto px-4 py-8 max-w-5xl text-center text-gray-500 dark:text-gray-400"},He=Y({__name:"[id]",setup(Ie){const m=O().params.id||"",g=c(!0),b=c(null),f=c(null),_=c(""),d=c({}),k=c(""),i=c([]),x=c(!1),$=c(!1),M=c(0),N=j(()=>document.documentElement.classList.contains("dark")),H=()=>{const r=document.documentElement;r.classList.toggle("dark"),localStorage.theme=r.classList.contains("dark")?"dark":"light"},I=()=>{if(i.value.length===0){alert("本文暂无章节目录");return}x.value=!x.value},S=async()=>{g.value=!0,b.value=null,await z(),g.value=!1},z=async()=>{try{g.value=!0;const r=await queryContent(`/articles/${m}`).findOne();if(!r||!r._raw)throw new Error(`未找到${m}的MD文件，或文件内容为空`);k.value=r._raw,console.log(`文章${m}原始MD：`,k.value);const t=await X(k.value);_.value=t.html||"<p>暂无文章内容</p>",d.value={title:r.title||m,date:r.date||"未知",updated:r.updated||r.date||"未知",category:r.category||"未分类",tags:r.tags||[],description:r.description||""},await Q(),D()}catch(r){b.value=r,_.value=`<div class="text-red-500 dark:text-red-400 py-8 text-center">加载失败：${r.message}</div>`,console.error("文章加载错误：",r)}finally{g.value=!1}},D=()=>{if(!f.value)return;i.value=[],f.value.querySelectorAll("h1, h2, h3, h4, h5, h6").forEach((t,u)=>{const o=t,v=Number(o.tagName.replace("H","")),p=o.textContent?.trim()||`标题${u+1}`,C=`heading-${v}-${u}-${p.replace(/\W+/g,"-").toLowerCase()}`;o.id=C,i.value.push({id:C,text:p,level:v,isActive:!1})}),y()},A=r=>{const t=document.getElementById(r);t&&(t.scrollIntoView({behavior:"smooth",block:"start"}),window.scrollBy(0,-80))},y=()=>{if(M.value=window.scrollY,$.value=M.value>100,i.value.length===0||!f.value)return;let r=0;const t=M.value+100;i.value.forEach((o,v)=>{const p=document.getElementById(o.id);if(!p)return;p.offsetTop<=t&&(r=v),o.isActive=!1});const u=i.value[r];u&&(u.isActive=!0)},R=()=>{window.scrollTo({top:0,behavior:"smooth"})},L=j(()=>k.value&&k.value.replace(/```[\s\S]*?```/g,"").replace(/`[^`]+`/g,"").replace(/\[.*?\]\(.*?\)/g,"").replace(/!\[.*?\]\(.*?\)/g,"").replace(/^---[\s\S]*?---/m,"").replace(/[#*`~>_\-=+|()[\]{};:,.!?]/g,"").replace(/\s+/g,"").length||0),q=j(()=>{const r=L.value;return r>0?Math.ceil(r/300):1});return U(async()=>{(localStorage.theme==="dark"||!("theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches)&&document.documentElement.classList.add("dark"),await z(),window.addEventListener("scroll",y),y(),g.value=!1}),W(()=>{window.removeEventListener("scroll",y)}),(r,t)=>{const u=F;return a(),l("div",ee,[e("header",te,[e("div",re,[t[3]||(t[3]=e("a",{href:"/",class:"text-xl font-bold text-blue-600 dark:text-blue-400"},"Nuxt 技术博客",-1)),e("nav",oe,[t[2]||(t[2]=G('<ul class="flex gap-6" data-v-def138a7><li data-v-def138a7><a href="/" class="text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 transition-colors" data-v-def138a7>首页</a></li><li data-v-def138a7><a href="/tags" class="text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 transition-colors" data-v-def138a7>标签</a></li><li data-v-def138a7><a href="/categories" class="text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 transition-colors" data-v-def138a7>分类</a></li><li data-v-def138a7><a href="/archives" class="text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 transition-colors" data-v-def138a7>归档</a></li></ul>',1)),e("button",{onClick:H,class:"p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors","aria-label":"切换暗黑模式"},[(a(),l("svg",se,[s(N)?(a(),l("path",ae)):(a(),l("path",le))]))])])])]),e("main",ne,[e("div",de,[e("div",ie,[t[4]||(t[4]=e("h3",{class:"text-lg font-semibold text-gray-800 dark:text-white mb-3 border-b border-gray-200 dark:border-gray-700 pb-2"},"文章目录",-1)),s(i).length>0?(a(),l("div",ce,[(a(!0),l(T,null,B(s(i),o=>(a(),l("li",{key:o.id,class:V(["pl-"+(o.level-1)*4,o.isActive?"text-blue-600 dark:text-blue-400 font-medium":"text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400","cursor-pointer transition-colors py-1"]),onClick:v=>A(o.id)},n(o.text),11,ue))),128))])):(a(),l("div",ge," 暂无章节目录 "))]),e("button",{class:"lg:hidden fixed bottom-6 right-6 z-30 bg-blue-600 text-white w-12 h-12 rounded-full shadow-lg flex items-center justify-center",onClick:I},[...t[5]||(t[5]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h16"})],-1)])]),s(x)?(a(),l("div",{key:0,class:"lg:hidden fixed inset-0 z-40 bg-black/50 backdrop-blur-sm flex items-end",onClick:t[1]||(t[1]=J(o=>x.value=!1,["self"]))},[e("div",xe,[e("div",he,[t[7]||(t[7]=e("h3",{class:"text-lg font-semibold text-gray-800 dark:text-white"},"文章目录",-1)),e("button",{onClick:t[0]||(t[0]=o=>x.value=!1)},[...t[6]||(t[6]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),s(i).length>0?(a(),l("div",ke,[(a(!0),l(T,null,B(s(i),o=>(a(),l("li",{key:o.id,class:V(["pl-"+(o.level-1)*4,o.isActive?"text-blue-600 dark:text-blue-400 font-medium":"text-gray-600 dark:text-gray-400","cursor-pointer py-1"]),onClick:()=>{A(o.id),x.value=!1}},n(o.text),11,ve))),128))])):(a(),l("div",pe," 暂无章节目录 "))])])):w("",!0)]),e("div",we,[s(g)?(a(),l("div",me,[...t[8]||(t[8]=[e("div",{class:"inline-block w-12 h-12 border-4 border-blue-200 dark:border-blue-800 border-t-blue-500 dark:border-t-blue-400 rounded-full animate-spin mb-4"},null,-1),e("p",{class:"text-gray-500 dark:text-gray-400 text-xl"},"正在加载文章...",-1)])])):w("",!0),s(b)?(a(),l("div",be,[t[9]||(t[9]=e("div",{class:"bg-red-100 dark:bg-red-900/30 text-red-500 dark:text-red-400 rounded-full w-16 h-16 flex items-center justify-center mb-4"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e("p",fe,n(s(b).message),1),e("button",{class:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",onClick:S}," 重新加载 ")])):(a(),l("div",ye,[e("div",_e,[e("h1",Me,n(s(d)?.title||"未命名文章"),1),e("div",Ce,[e("span",Te,[t[10]||(t[10]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),h(" 发布时间："+n(s(d)?.date||"未知"),1)]),s(d)?.updated?(a(),l("span",Be,[t[11]||(t[11]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)),h(" 更新时间："+n(s(d)?.updated||"未知"),1)])):w("",!0),e("span",je,[t[12]||(t[12]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),h(" 阅读时长："+n(s(q))+" 分钟 ",1)]),e("span",$e,[t[13]||(t[13]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),h(" 字数统计："+n(s(L))+" 字 ",1)]),e("span",ze,[t[14]||(t[14]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})],-1)),K(u,{to:`/categories/${s(d)?.category||"未分类"}`,class:"text-blue-600 dark:text-blue-400 hover:underline transition-colors"},{default:E(()=>[h(n(s(d)?.category||"未分类"),1)]),_:1},8,["to"])])]),e("div",Ae,[t[15]||(t[15]=e("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"标签：",-1)),(a(!0),l(T,null,B(s(d)?.tags||[],o=>(a(),P(u,{key:o,to:`/tags/${o}`,class:"bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 px-2.5 py-1 rounded-full text-xs hover:bg-blue-100 dark:hover:bg-blue-800/50 transition-colors"},{default:E(()=>[h(n(o),1)]),_:2},1032,["to"]))),128)),!s(d)?.tags||s(d).tags.length===0?(a(),l("span",Le,"无标签")):w("",!0)])]),e("div",{ref_key:"articleContentRef",ref:f,class:"p-6 md:p-8 prose prose-blue prose-lg dark:prose-invert max-w-none",innerHTML:s(_)},null,8,Ve)]))])]),s($)?(a(),l("button",{key:0,class:"fixed bottom-6 right-20 lg:right-6 z-30 bg-blue-600 text-white w-12 h-12 rounded-full shadow-lg flex items-center justify-center hover:bg-blue-700 transition-colors",onClick:R,"aria-label":"返回顶部"},[...t[16]||(t[16]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 15l7-7 7 7"})],-1)])])):w("",!0),e("footer",Ee,[e("div",Ne,[e("p",null,"© "+n(new Date().getFullYear())+" 我的 Nuxt4 技术博客 | 基于 Nuxt4 构建",1)])])])}}}),Ye=Z(He,[["__scopeId","data-v-def138a7"]]);export{Ye as default};
