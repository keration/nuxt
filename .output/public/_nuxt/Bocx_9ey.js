import{m as A,R as b,z as O,a2 as R,S as I,a3 as D,p as x,f as T}from"./BpSb0wkX.js";import{i as N}from"./BJ2ClxiI.js";function f(e){if(typeof e!="object")return e;var i,o,t=Object.prototype.toString.call(e);if(t==="[object Object]"){if(e.constructor!==Object&&typeof e.constructor=="function"){o=new e.constructor;for(i in e)e.hasOwnProperty(i)&&o[i]!==e[i]&&(o[i]=f(e[i]))}else{o={};for(i in e)i==="__proto__"?Object.defineProperty(o,i,{value:f(e[i]),configurable:!0,enumerable:!0,writable:!0}):o[i]=f(e[i])}return o}if(t==="[object Array]"){for(i=e.length,o=Array(i);i--;)o[i]=f(e[i]);return o}return t==="[object Set]"?(o=new Set,e.forEach(function(a){o.add(f(a))}),o):t==="[object Map]"?(o=new Map,e.forEach(function(a,n){o.set(f(n),f(a))}),o):t==="[object Date]"?new Date(+e):t==="[object RegExp]"?(o=new RegExp(e.source,e.flags),o.lastIndex=e.lastIndex,o):t==="[object DataView]"?new e.constructor(f(e.buffer)):t==="[object ArrayBuffer]"?e.slice(0):t.slice(-6)==="Array]"?new e.constructor(e):e}function L(e,i){if(typeof e!="string")throw new TypeError("argument str must be a string");const o={},t=i||{},a=t.decode||M;let n=0;for(;n<e.length;){const r=e.indexOf("=",n);if(r===-1)break;let s=e.indexOf(";",n);if(s===-1)s=e.length;else if(s<r){n=e.lastIndexOf(";",r-1)+1;continue}const c=e.slice(n,r).trim();if(t?.filter&&!t?.filter(c)){n=s+1;continue}if(o[c]===void 0){let u=e.slice(r+1,s).trim();u.codePointAt(0)===34&&(u=u.slice(1,-1)),o[c]=U(u,a)}n=s+1}return o}function M(e){return e.includes("%")?decodeURIComponent(e):e}function U(e,i){try{return i(e)}catch{return e}}const h=/^[\u0009\u0020-\u007E\u0080-\u00FF]+$/;function E(e,i,o){const t=o||{},a=t.encode||encodeURIComponent;if(typeof a!="function")throw new TypeError("option encode is invalid");if(!h.test(e))throw new TypeError("argument name is invalid");const n=a(i);if(n&&!h.test(n))throw new TypeError("argument val is invalid");let r=e+"="+n;if(t.maxAge!==void 0&&t.maxAge!==null){const s=t.maxAge-0;if(Number.isNaN(s)||!Number.isFinite(s))throw new TypeError("option maxAge is invalid");r+="; Max-Age="+Math.floor(s)}if(t.domain){if(!h.test(t.domain))throw new TypeError("option domain is invalid");r+="; Domain="+t.domain}if(t.path){if(!h.test(t.path))throw new TypeError("option path is invalid");r+="; Path="+t.path}if(t.expires){if(!_(t.expires)||Number.isNaN(t.expires.valueOf()))throw new TypeError("option expires is invalid");r+="; Expires="+t.expires.toUTCString()}if(t.httpOnly&&(r+="; HttpOnly"),t.secure&&(r+="; Secure"),t.priority)switch(typeof t.priority=="string"?t.priority.toLowerCase():t.priority){case"low":{r+="; Priority=Low";break}case"medium":{r+="; Priority=Medium";break}case"high":{r+="; Priority=High";break}default:throw new TypeError("option priority is invalid")}if(t.sameSite)switch(typeof t.sameSite=="string"?t.sameSite.toLowerCase():t.sameSite){case!0:{r+="; SameSite=Strict";break}case"lax":{r+="; SameSite=Lax";break}case"strict":{r+="; SameSite=Strict";break}case"none":{r+="; SameSite=None";break}default:throw new TypeError("option sameSite is invalid")}return t.partitioned&&(r+="; Partitioned"),r}function _(e){return Object.prototype.toString.call(e)==="[object Date]"||e instanceof Date}const q={path:"/",watch:!0,decode:e=>R(decodeURIComponent(e)),encode:e=>encodeURIComponent(typeof e=="string"?e:JSON.stringify(e))},v=globalThis.cookieStore;function y(e,i){const o={...q,...i};o.filter??=u=>u===e;const t=C(o)||{};let a;o.maxAge!==void 0?a=o.maxAge*1e3:o.expires&&(a=o.expires.getTime()-Date.now());const n=a!==void 0&&a<=0,r=n||t[e]===void 0||t[e]===null,s=f(n?void 0:t[e]??o.default?.()),c=a&&!n?F(s,a,o.watch&&o.watch!=="shallow"):A(s);{let u=null;try{!v&&typeof BroadcastChannel<"u"&&(u=new BroadcastChannel(`nuxt:cookies:${e}`))}catch{}const p=(l=!1)=>{!l&&(o.readonly||N(c.value,t[e]))||(B(e,c.value,o),t[e]=f(c.value),u?.postMessage({value:o.encode(c.value)}))},d=l=>{const w=l.refresh?C(o)?.[e]:o.decode(l.value);m=!0,c.value=w,t[e]=f(w),x(()=>{m=!1})};let m=!1;const k=!!I();if(k&&b(()=>{m=!0,p(),u?.close()}),v){const l=w=>{const S=w.changed.find(g=>g.name===e),P=w.deleted.find(g=>g.name===e);S&&d({value:S.value}),P&&d({value:null})};v.addEventListener("change",l),k&&b(()=>v.removeEventListener("change",l))}else u&&(u.onmessage=({data:l})=>d(l));o.watch&&O(c,()=>{m||p()},{deep:o.watch!=="shallow"}),r&&p(r)}return c}function C(e={}){return L(document.cookie,e)}function z(e,i,o={}){return i==null?E(e,i,{...o,maxAge:-1}):E(e,i,o)}function B(e,i,o={}){document.cookie=z(e,i,o)}const j=2147483647;function F(e,i,o){let t,a,n=0;const r=o?A(e):{value:e};return I()&&b(()=>{a?.(),clearTimeout(t)}),D((s,c)=>{o&&(a=O(r,c));function u(){n=0,clearTimeout(t);const p=i-n,d=p<j?p:j;t=setTimeout(()=>{if(n+=d,n<i)return u();r.value=void 0,c()},d)}return{get(){return s(),r.value},set(p){u(),r.value=p,c()}}})}const $=()=>({isEnabled:()=>{const t=T().query;return Object.prototype.hasOwnProperty.call(t,"preview")&&!t.preview?!1:!!(t.preview||y("previewToken").value||sessionStorage.getItem("previewToken"))},getPreviewToken:()=>y("previewToken").value||sessionStorage.getItem("previewToken")||void 0,setPreviewToken:t=>{y("previewToken").value=t,T().query.preview=t||"",t?sessionStorage.setItem("previewToken",t):sessionStorage.removeItem("previewToken"),window.location.reload()}});export{$ as u};
