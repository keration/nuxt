import{ah as k,ag as x,M as P,N as b,ai as C,aj as q,ak as D,P as j,E as M,q as p,al as H,g as T,o as A,c as F,am as z,a4 as G,an as V,ao as J,m as K,e as Q,l as Z,j as I,ap as X,H as Y}from"./BpSb0wkX.js";async function ee(e,t){return await te(t).catch(r=>(console.error("Failed to get image meta for "+t,r+""),{width:0,height:0,ratio:0}))}async function te(e){if(typeof Image>"u")throw new TypeError("Image not supported");return new Promise((t,i)=>{const r=new Image;r.onload=()=>{const s={width:r.width,height:r.height,ratio:r.width/r.height};t(s)},r.onerror=s=>i(s),r.src=e})}function W(e){return(t=>t!==void 0?e[t]||t:e.missingValue)}function re(e={}){const t=e.formatter,i=e.keyMap&&typeof e.keyMap!="function"?W(e.keyMap):e.keyMap,r={};for(const s in e.valueMap){const n=s,c=e.valueMap[n];r[n]=typeof c=="object"?W(c):c}return s=>{const n=[];for(const c in s){const a=c;if(typeof s[a]>"u")continue;const f=typeof r[a]=="function"?r[a](s[a]):s[a];n.push([i?i(a):a,f])}return t?n.map(c=>t(...c)).join(e.joinWith??"&"):new URLSearchParams(n).toString()}}function ie(e=""){if(e===void 0||!e.length)return[];const t=new Set;for(const i of e.split(" ")){const r=Number.parseInt(i.replace("x",""));r&&t.add(r)}return Array.from(t)}function se(e){if(e.length===0)throw new Error("`densities` must not be empty, configure to `1` to render regular size only (DPR 1.0)")}function y(e=""){if(typeof e=="number")return e;if(typeof e=="string"&&e.replace("px","").match(/^\d+$/g))return Number.parseInt(e,10)}function ne(e){const t={};if(typeof e=="string")for(const i of e.split(/[\s,]+/).filter(r=>r)){const r=i.split(":");r.length!==2?t["1px"]=r[0].trim():t[r[0].trim()]=r[1].trim()}else Object.assign(t,e);return t}function oe(e){const t={options:e},i=(s,n={})=>E(t,s,n),r=((s,n,c)=>i(s,k({modifiers:n},c)).url);for(const s in e.presets)r[s]=((n,c,a)=>r(n,c,{...e.presets[s],...a}));return r.options=e,r.getImage=i,r.getMeta=((s,n)=>ae(t,s,n)),r.getSizes=((s,n)=>de(t,s,n)),t.$img=r,r}async function ae(e,t,i){const r=E(e,t,{...i});return typeof r.getMeta=="function"?await r.getMeta():await ee(e,r.url)}function E(e,t,i){if(t&&typeof t!="string")throw new TypeError(`input must be a string (received ${typeof t}: ${JSON.stringify(t)})`);if(!t||t.startsWith("data:"))return{url:t};const{setup:r,defaults:s}=ce(e,i.provider||e.options.provider),n=r(),c=O(e,i.preset);if(t=x(t)?t:P(t),!n.supportsAlias){for(const u in e.options.alias)if(t.startsWith(u)){const g=e.options.alias[u];g&&(t=b(g,t.slice(u.length)))}}if(n.validateDomains&&x(t)){const u=C(t).host;if(!e.options.domains.find(g=>g===u))return{url:t}}const a=k(i,c,s),f={...a,modifiers:{...a.modifiers,width:a.modifiers?.width?y(a.modifiers.width):void 0,height:a.modifiers?.height?y(a.modifiers.height):void 0}},h=n.getImage(t,f,e);return h.format||=f.modifiers.format||"",h}function ce(e,t){const i=e.options.providers[t];if(!i)throw new Error("Unknown provider: "+t);return i}function O(e,t){if(!t)return{};if(!e.options.presets[t])throw new Error("Unknown preset: "+t);return e.options.presets[t]}function de(e,t,i){const r=O(e,i.preset),s=k(i,r),n=y(s.modifiers?.width),c=y(s.modifiers?.height),a=s.sizes?ne(s.sizes):{},f=s.densities?.trim(),h=f?ie(f):e.options.densities;se(h);const u=n&&c?c/n:0,g=[],m=[];if(Object.keys(a).length>=1){for(const d in a){const o=$(d,String(a[d]),c,u,e);if(o!==void 0){g.push({size:o.size,screenMaxWidth:o.screenMaxWidth,media:`(max-width: ${o.screenMaxWidth}px)`});for(const l of h)m.push({width:o._cWidth*l,src:N(e,t,i,o,l)})}}le(g)}else for(const d of h){const o=Object.keys(a)[0];let l=o?$(o,String(a[o]),c,u,e):void 0;l===void 0&&(l={size:"",screenMaxWidth:0,_cWidth:i.modifiers?.width,_cHeight:i.modifiers?.height}),m.push({width:d,src:N(e,t,i,l,d)})}ue(m);const w=m[m.length-1],v=g.length?g.map(d=>`${d.media?d.media+" ":""}${d.size}`).join(", "):void 0,S=v?"w":"x",_=m.map(d=>`${d.src} ${d.width}${S}`).join(", ");return{sizes:v,srcset:_,src:w?.src}}function $(e,t,i,r,s){const n=s.options.screens&&s.options.screens[e]||Number.parseInt(e),c=t.endsWith("vw");if(!c&&/^\d+$/.test(t)&&(t=t+"px"),!c&&!t.endsWith("px"))return;let a=Number.parseInt(t);if(!n||!a)return;c&&(a=Math.round(a/100*n));const f=r?Math.round(a*r):i;return{size:t,screenMaxWidth:n,_cWidth:a,_cHeight:f}}function N(e,t,i,r,s){return e.$img(t,{...i.modifiers,width:r._cWidth?r._cWidth*s:void 0,height:r._cHeight?r._cHeight*s:void 0},i)}function le(e){e.sort((i,r)=>i.screenMaxWidth-r.screenMaxWidth);let t=null;for(let i=e.length-1;i>=0;i--){const r=e[i];r.media===t&&e.splice(i,1),t=r.media}for(let i=0;i<e.length;i++)e[i].media=e[i+1]?.media||""}function ue(e){e.sort((i,r)=>i.width-r.width);let t=null;for(let i=e.length-1;i>=0;i--){const r=e[i];r.width===t&&e.splice(i,1),t=r.width}}function fe(e){let t;return()=>t||(t=typeof e=="function"?e():e,t)}const he=re({keyMap:{format:"f",width:"w",height:"h",resize:"s",quality:"q",background:"b",position:"pos"},formatter:(e,t)=>q(e)+"_"+q(t.toString())}),ge=fe({validateDomains:!0,supportsAlias:!0,getImage:(e,{modifiers:t,baseURL:i},r)=>{t.width&&t.height&&(t.resize=`${t.width}x${t.height}`,delete t.width,delete t.height);const s=he(t)||"_";return i||(i=b(r.options.nuxt.baseURL,"/_ipx")),{url:b(i,s,D(e))}}}),me={screens:{sm:640,md:768,lg:1024,xl:1280,"2xl":1536},presets:{},provider:"ipx",domains:[],alias:{},densities:[1,2],format:["webp"],provider:"ipx",providers:{ipx:{setup:ge,defaults:{}}}},L=e=>{const t=M(),i=j();return i.$img||i._img||(i._img=oe({...me,event:i.ssrContext?.event,nuxt:{baseURL:t.app.baseURL},runtimeConfig:t}))};function pe(e){performance?.mark?.("mark_feature_usage",{detail:{feature:e}})}const ve=e=>{const t=L(),i=p(()=>({provider:e.provider,preset:e.preset})),r=p(()=>({width:y(e.width),height:y(e.height),crossorigin:e.crossorigin===!0?"anonymous":e.crossorigin||void 0,nonce:e.nonce})),s=p(()=>({...e.modifiers,width:e.width,height:e.height,format:e.format,quality:e.quality||t.options.quality,background:e.background,fit:e.fit}));return{providerOptions:i,normalizedAttrs:r,imageModifiers:s}},ye=["src"],we={__name:"NuxtImg",props:{custom:{type:Boolean,required:!1},placeholder:{type:[Boolean,String,Number,Array],required:!1},placeholderClass:{type:String,required:!1},src:{type:String,required:!1},format:{type:String,required:!1},quality:{type:[String,Number],required:!1},background:{type:String,required:!1},fit:{type:String,required:!1},modifiers:{type:Object,required:!1},preset:{type:String,required:!1},provider:{type:null,required:!1},sizes:{type:[String,Object],required:!1},densities:{type:String,required:!1},preload:{type:[Boolean,Object],required:!1},width:{type:[String,Number],required:!1},height:{type:[String,Number],required:!1},crossorigin:{type:[String,Boolean],required:!1},nonce:{type:String,required:!1}},emits:["load","error"],setup(e,{expose:t,emit:i}){const r=e,s=i,n=L(),{providerOptions:c,normalizedAttrs:a,imageModifiers:f}=ve(r),h=p(()=>n.getSizes(r.src,{...c.value,sizes:r.sizes,densities:r.densities,modifiers:f.value})),u=K(!1),g=H(),m=p(()=>({...a.value,"data-nuxt-img":"",...!r.placeholder||u.value?{sizes:h.value.sizes,srcset:h.value.srcset}:{},...g})),w=p(()=>{if(u.value)return!1;const o=r.placeholder===""?[10,10]:r.placeholder;if(!o)return!1;if(typeof o=="string")return o;const[l=10,R=l,B=50,U=3]=Array.isArray(o)?o:typeof o=="number"?[o]:[];return n(r.src,{...f.value,width:l,height:R,quality:B,blur:U},c.value)}),v=p(()=>r.sizes?h.value.src:n(r.src,f.value,c.value)),S=p(()=>w.value||v.value),_=j().isHydrating,d=J("imgEl");return t({imgEl:d}),T(()=>{if(w.value||r.custom){const o=new Image;v.value&&(o.src=v.value),r.sizes&&(o.sizes=h.value.sizes||"",o.srcset=h.value.srcset),o.decode?o.decode().then(()=>{u.value=!0,s("load",new Event("load"))}).catch(l=>{s("error",l)}):(o.onload=l=>{u.value=!0,s("load",l)},o.onerror=l=>{s("error",l)}),pe("nuxt-image");return}d.value&&(d.value.complete&&_&&(d.value.getAttribute("data-error")?s("error",new Event("error")):s("load",new Event("load"))),d.value.onload=o=>{s("load",o)},d.value.onerror=o=>{s("error",o)})}),(o,l)=>e.custom?G(o.$slots,"default",V(z({key:1},{imgAttrs:m.value,isLoaded:u.value,src:S.value}))):(A(),F("img",z({key:0,ref_key:"imgEl",ref:d,class:w.value?e.placeholderClass:void 0},m.value,{src:S.value}),null,16,ye))}},Se=Object.assign(we,{__name:"NuxtImg"}),be=Q({__name:"ProseImg",props:{src:{type:String,default:""},alt:{type:String,default:""},width:{type:[String,Number],default:void 0},height:{type:[String,Number],default:void 0}},setup(e){const t=M().public.mdc.useNuxtImage?Se:"img",i=e,r=p(()=>{if(i.src?.startsWith("/")&&!i.src.startsWith("//")){const s=P(Y(M().app.baseURL));if(s!=="/"&&!i.src.startsWith(s))return b(s,i.src)}return i.src});return(s,n)=>(A(),Z(X(I(t)),{src:I(r),alt:e.alt,width:e.width,height:e.height},null,8,["src","alt","width","height"]))}}),Me=Object.assign(be,{__name:"ProseImg"});export{Me as default};
